<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CO₂-beregner</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 0;
      background-color: #f3f3f3;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      min-height: 100vh;
    }
    .container {
      background-color: white;
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 600px;
      margin-bottom: 20px;
    }
    h1, h2, h3 {
      text-align: center;
      color: #333;
      margin-top: 0px;
    }
    h3 {
      cursor: pointer;
    }
    label {
      display: block;
      margin-bottom: 0px;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    input[type="number"] {
      -moz-appearance: textfield;
    }
    .result {
      font-size: 1.2em;
      text-align: center;
    }
    #paymentDiv {
      text-align: center;
    }
    .bold-money {
      font-weight: bold;
      font-size: 1.5em;
      margin-top: 10px;
      color: #4CAF50;
    }
    .explanation {
      font-size: 0.9em;
      background-color: #e9e9e9;
      padding: 10px;
      border-radius: 5px;
      margin-top: 20px;
    }
    #costDisplay {
      text-align: center;
    }

    /* Mobile friendly adjustments */
    @media only screen and (max-width: 600px) {
      .container {
        margin: 0 10px; /* Add padding to left and right sides */
        padding: 20px 0px; /* Add padding on left and right for mobile */
      }

      input, select {
        padding: 10px;
        margin-bottom: 5px;
        border-radius: 5px;
        border: 1px solid #ccc;
        width: 100%;
        box-sizing: border-box; /* Ensure padding is included in the width */
      }
    }

    #co2Form {
      padding: 0px 10px;
    }

    #explanationcontent {
      padding: 0px 10px;
    }

    .inline-fields {
      display: flex;
      justify-content: space-between;
      gap: 20px; /* Space between the two sets of label/select pairs */
    }
    .inline-fields label {
      margin-right: 10px;
    }
    .inline-fields select {
      width: 100%;
    }

    #formContainer {
      display: block;
    }

    #explanationContainer {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>CO₂-beregner pr. år</h2>
    
    <div id="formContainer">
      <form id="co2Form">
        <label for="householdSize">Personer i husstanden</label>
        <input type="number" id="householdSize" name="householdSize" value="2" required min="1">

        <label for="carKilometers">Kilometer i bil af type</label>
        <div class="inline-fields">
          <input type="number" id="carKilometers" name="carKilometers" value="14500" required min="0">
          <select id="carType" name="carType" required>
            <option value="gasoline">Benzinbil</option>
            <option value="diesel">Dieselbil</option>
            <option value="hybrid">Hybridbil</option>
            <option value="electric">Elbil</option>
          </select>
        </div>

        <label for="electricityUse">El i kWh for husstanden
            <small>
              <i>
                <span id="electricCarNotice" style="display: none;">(Elforbrug til elbil skal medregnes. Km/per ovenfor ignoreres.)</span>
              </i>
            </small>
        </label>
        <input type="number" id="electricityUse" name="electricityUse" value="3600" required min="0">

        <label for="heatingUse">Varme i kWh for husstanden af type</label>
        <div class="inline-fields">
          <input type="number" id="heatingUse" name="heatingUse" value="20000" required min="0">
          <select id="heatingType" name="heatingType" required>
            <option value="electric">Elvarme</option>
            <option value="gas">Naturgas</option>
            <option value="district" selected>Fjernvarme</option>
            <option value="biomass">Biomasse</option>
            <option value="oil">Oliefyr</option>
            <option value="heatpump">Varmepumpe</option>
          </select>
        </div>

        <div class="inline-fields">
          <div style="width: 100%">
              <label for="housingType">Korte flyvninger <br><small><i>(indenfor EU, 1000 km)</i></small></label>
            <input type="number" id="shortFlights" name="shortFlights" value="5" required>
          </div>
          
          <div style="width: 100%">
              <label for="housingType">Lange flyninger <br><small><i>(udenfor EU, 3000km)</i></small></label>
            <input type="number" id="longFlights" name="longFlights" value="2" required>
          </div>
        </div>

        <div class="inline-fields">
          <div style="width: 100%">
            <label for="housingType">Boligtype</label>
            <select id="housingType" name="housingType" required>
              <option value="house">Hus</option>
              <option value="apartment">Lejlighed</option>
            </select>
          </div>

          <div style="width: 100%">
            <label for="dietType">Kostvaner</label>
            <select id="dietType" name="dietType" required>
              <option value="meat">Kødspiser</option>
              <option value="vegetarian">Vegetar</option>
            </select>
          </div>
        </div>

        <label for="clothing">Tøjkøb</label>
        <select id="clothing" name="clothing" required>
          <option value="5">0-9 stykker tøj.</option>
          <option value="15" selected>10-19 stykker tøj.</option>
          <option value="25">20-29 stykker tøj.</option>
          <option value="35">30-39 stykker tøj.</option>
          <option value="45">40-49 stykker tøj.</option>
          <option value="60">50 stk. eller flere</option>
        </select>
      </form>

      <div id="costDisplay">
        <p style="margin: 0px 1px;">Prisen for at kompensere for dine <span style="white-space: nowrap">CO₂-udledninger</span>:</p>
        <p class="bold-money">
          <span id="costToOffset"></span>
          <span style="display: none;" id="mobilepay">
            <span style="color: black">-</span>
            <a id="mobilepay-link">Betal</a>
          </span>
        </p>
      </div>
    </div>

    <h3 id="explanationHeading"><u>Sådan beregnes prisen</u></h3>

    <div id="explanationContainer">
      <div id="explanationcontent">
        <ul>
          <li><strong>Bil</strong>: Kilometer pr. år × 0,2 kg CO₂/km.</li>
          <li><strong>El</strong>: kWh pr. år × 0,233 kg CO₂/kWh. / husstand</li>
          <li><strong>Varme</strong>: kWh pr. år × CO₂-udledning pr. energikilde. / husstand</li>
          <li><strong>Flyvninger</strong>: Korte flyvninger × 150 kg CO₂, lange flyvninger × 800 kg CO₂.</li>
          <li><strong>Tøjforbrug</strong>: 10 kg CO₂ per stykke tøj.</li>
          <li><strong>Bolig og kostvaner:</strong>Hus (+500 kg CO₂), Kødspiser (+1000 kg CO₂)</li>
          <li><strong>Andet</strong>: 300 kg CO₂ (dagligvarer, affald, møbler, elektronik, madspild)</li>
        </ul>
        <p style="text-align: center; margin-bottom: 0px;">
          Prisen for kompensation antages at være
        </p>
        <p style="text-align: center; margin-top: 5px;">
          <b>200 DKK per ton CO₂.</b>
        </p>
      </div>
      <button onclick="toggleForm()">Tilbage til beregning</button>
    </div>
  </div>
  <script>
    const CAR_CO2_EMISSION_PER_KM_GASOLINE = 0.2;  // kg CO₂ per km for gasoline
    const CAR_CO2_EMISSION_PER_KM_DIESEL = 0.25;   // kg CO₂ per km for diesel
    const CAR_CO2_EMISSION_PER_KM_HYBRID = 0.1;    // kg CO₂ per km for hybrid
    const CAR_CO2_EMISSION_PER_KM_ELECTRIC = 0.05;  // kg CO₂ per km for electric
    const ELECTRICITY_CO2_EMISSION_PER_KWH = 0.233; // kg CO₂ per kWh
    const SHORT_FLIGHT_CO2_EMISSION = 150; // kg CO₂ pr. kort flyvning
    const LONG_FLIGHT_CO2_EMISSION = 800; // kg CO₂ pr. lang flyvning
    const CLOTHING_CO2_EMISSION_PER_ITEM = 10; // kg CO₂ per stykke tøj
    
    // Emissioner fra øvrige kilder
    const BASE_OTHER_EMISSIONS = 500; // Basisudledning
    const HOUSING_EMISSIONS_HOUSE = 500; // Ekstra udledning, hvis du bor i et hus
    const HOUSING_EMISSIONS_APARTMENT = 0; // Ingen ekstra udledning, hvis du bor i en lejlighed
    const DIET_EMISSIONS_MEAT = 1000; // Ekstra udledning for kødspisende kost
    const DIET_EMISSIONS_VEGETARIAN = 500; // Ekstra udledning for vegetarisk kost

    // CO₂-udledning pr. kWh for forskellige varmekilder
    const HEATING_EMISSIONS_ELECTRIC = 0.233;  // Elvarme (samme som elforbrug)
    const HEATING_EMISSIONS_GAS = 0.185;      // Naturgas
    const HEATING_EMISSIONS_DISTRICT = 0.05;   // Fjernvarme (kan variere afhængig af kilde)
    const HEATING_EMISSIONS_BIOMASS = 0.035;   // Biomasse
    const HEATING_EMISSIONS_OIL = 0.267;       // Oliefyr
    const HEATING_EMISSIONS_HEATPUMP = 0.05;   // Varmepumpe

    // Pris per ton CO₂ og omregningskurs
    const PRICE_PER_TON_DKK = 200; // DKK per ton CO₂

    document.querySelectorAll('#co2Form input, #co2Form select').forEach(input => {
      input.addEventListener('input', updateCO2Cost);
    });

    function updateCO2Cost() {
      // Hent inputværdier
      const housingType = document.getElementById('housingType').value;
      const dietType = document.getElementById('dietType').value;
      const clothingCount = parseInt(document.getElementById('clothing').value);
      const carType = document.getElementById('carType').value;
      const heatingType = document.getElementById('heatingType').value;

      let carKilometers = parseFloat(document.getElementById('carKilometers').value); // default 14500;
      let electricityUse = parseFloat(document.getElementById('electricityUse').value); // default 3600;
      let shortFlights = parseFloat(document.getElementById('shortFlights').value); // default 5;
      let longFlights = parseFloat(document.getElementById('longFlights').value); // default 2;
      let householdSize = parseInt(document.getElementById('householdSize').value); // default 2;
      let heatingUse = parseFloat(document.getElementById('heatingUse').value); // default 20000;

      // If values are not numeric, set them to default values
      if (isNaN(carKilometers)) { carKilometers = 14500; }
      if (isNaN(electricityUse)) { electricityUse = 3600; }
      if (isNaN(shortFlights)) { shortFlights = 5; }
      if (isNaN(longFlights)) { longFlights = 2; }
      if (isNaN(householdSize)) { householdSize = 2; }
      if (isNaN(heatingUse)) { heatingUse = 20000; }

      // Bestem emissionsfaktor for biltypen
      let carEmissionFactor;
      switch (carType) {
        case 'gasoline':
          carEmissionFactor = CAR_CO2_EMISSION_PER_KM_GASOLINE;
          break;
        case 'diesel':
          carEmissionFactor = CAR_CO2_EMISSION_PER_KM_DIESEL;
          break;
        case 'hybrid':
          carEmissionFactor = CAR_CO2_EMISSION_PER_KM_HYBRID;
          break;
        case 'electric':
          carEmissionFactor = CAR_CO2_EMISSION_PER_KM_ELECTRIC;
          break;
        default:
          carEmissionFactor = CAR_CO2_EMISSION_PER_KM_GASOLINE; // Default to gasoline if not selected
          break;
      }

      // Bestem emissionsfaktor for varmeforbrug
      let heatingEmissionFactor;
      switch (heatingType) {
        case 'electric':
          heatingEmissionFactor = HEATING_EMISSIONS_ELECTRIC;
          break;
        case 'gas':
          heatingEmissionFactor = HEATING_EMISSIONS_GAS;
          break;
        case 'district':
          heatingEmissionFactor = HEATING_EMISSIONS_DISTRICT;
          break;
        case 'biomass':
          heatingEmissionFactor = HEATING_EMISSIONS_BIOMASS;
          break;
        case 'oil':
          heatingEmissionFactor = HEATING_EMISSIONS_OIL;
          break;
        case 'heatpump':
          heatingEmissionFactor = HEATING_EMISSIONS_HEATPUMP;
          break;
        default:
          heatingEmissionFactor = HEATING_EMISSIONS_ELECTRIC; // Default to electric if not selected
          break;
      }

      // Beregn udledninger fra transport og el (årligt)
      const carEmissions = (carKilometers * carEmissionFactor);
      const electricityEmissions = (electricityUse * ELECTRICITY_CO2_EMISSION_PER_KWH) / householdSize;
      const shortFlightEmissions = shortFlights * SHORT_FLIGHT_CO2_EMISSION;
      const longFlightEmissions = longFlights * LONG_FLIGHT_CO2_EMISSION;
      const heatingEmissions = (heatingUse * heatingEmissionFactor) / householdSize;

      // Bestem ekstra udledninger fra bolig og kost
      const housingEmissions = (housingType === "house") ? HOUSING_EMISSIONS_HOUSE : HOUSING_EMISSIONS_APARTMENT;
      const dietEmissions = (dietType === "meat") ? DIET_EMISSIONS_MEAT : DIET_EMISSIONS_VEGETARIAN;

      // Beregn udledning fra tøjforbrug
      const clothingEmissions = clothingCount * CLOTHING_CO2_EMISSION_PER_ITEM;

      // Beregn øvrige udledninger
      const otherEmissions = BASE_OTHER_EMISSIONS + housingEmissions + dietEmissions;

      // Total CO₂-udledning (kg/år)
      const totalEmissions = carEmissions + electricityEmissions + heatingEmissions + shortFlightEmissions + longFlightEmissions + clothingEmissions + otherEmissions;

      // Beregn kompensationsprisen
      const costInDKK = (totalEmissions / 1000) * PRICE_PER_TON_DKK;

      // Opdater prisen dynamisk
      document.getElementById('costToOffset').innerText = `${costInDKK.toFixed(0)} DKK`;
      document.getElementById('mobilepay-link').href = `mobilepay://send?phone=45650&amount=${costInDKK.toFixed(0)}`;
    }

    // Initial beregning
    updateCO2Cost();

    // Toggle visibility of the form and explanation
    function toggleForm() {
      document.getElementById('formContainer').style.display = 'block';
      document.getElementById('explanationContainer').style.display = 'none';
    }

    // Show explanation when clicked
    document.getElementById('explanationHeading').addEventListener('click', () => {
      document.getElementById('formContainer').style.display = 'none';
      document.getElementById('explanationContainer').style.display = 'block';
    });

    // Display mobilepay element if on mobile
    if (/Mobi|Android|iPhone|iPad|iPod/.test(navigator.userAgent)) {
      document.getElementById('mobilepay').style.display = 'inline';
    }

    document.getElementById('carType').addEventListener('change', function() {
      const carNotice = document.getElementById('electricCarNotice');
      if (this.value === 'electric') {
        carNotice.style.display = 'block';
      } else {
        carNotice.style.display = 'none';
      }
    });
  </script>
</body>
</html>
